(function(c,a,d,b){d.swipebox=function(k,w){var g={useCSS:true,hideBarsDelay:3000},v=this,t=d(k),k=k,n=k.selector,j=d(n),r=a.createTouch!==b||"ontouchstart" in c||"onmsgesturechange" in c||navigator.msMaxTouchPoints,m=!!c.SVGSVGElement,e='<div id="swipebox-overlay">					<div id="swipebox-slider"></div>					<div id="swipebox-caption"></div>					<div id="swipebox-action">						<a id="swipebox-close"></a>						<a id="swipebox-prev"></a>						<a id="swipebox-next"></a>					</div>			</div>';v.settings={};v.init=function(){v.settings=d.extend({},g,w);j.click(function(f){f.preventDefault();f.stopPropagation();index=t.index(d(this));q.init(index)})};var q={init:function(f){this.build();this.openSlide(f);this.openImg(f);this.preloadImg(f+1);this.preloadImg(f-1)},build:function(){var f=this;d("body").append(e);if(f.doCssTrans()){d("#swipebox-slider").css({"-webkit-transition":"left 0.4s ease","-moz-transition":"left 0.4s ease","-o-transition":"left 0.4s ease","-khtml-transition":"left 0.4s ease",transition:"left 0.4s ease"});d("#swipebox-overlay").css({"-webkit-transition":"opacity 1s ease","-moz-transition":"opacity 1s ease","-o-transition":"opacity 1s ease","-khtml-transition":"opacity 1s ease",transition:"opacity 1s ease"});d("#swipebox-action, #swipebox-caption").css({"-webkit-transition":"0.5s","-moz-transition":"0.5s","-o-transition":"0.5s","-khtml-transition":"0.5s",transition:"0.5s"})}if(m){var h=d("#swipebox-action #swipebox-close").css("background-image");h=h.replace("png","svg");d("#swipebox-action #swipebox-prev,#swipebox-action #swipebox-next,#swipebox-action #swipebox-close").css({"background-image":h})}t.each(function(){d("#swipebox-slider").append('<div class="slide"></div>')});f.setDim();f.actions();f.keyboard();f.gesture();f.animBars();d(c).resize(function(){f.setDim()}).resize()},setDim:function(){var f={width:d(c).width(),height:c.innerHeight?c.innerHeight:d(c).height()};d("#swipebox-overlay").css(f)},supportTransition:function(){var f="transition WebkitTransition MozTransition OTransition msTransition KhtmlTransition".split(" ");for(var h=0;h<f.length;h++){if(a.createElement("div").style[f[h]]!==b){return f[h]}}return false},doCssTrans:function(){if(v.settings.useCSS&&this.supportTransition()){return true}},gesture:function(){if(r){var u=this,h=null,p=10,f={},l={};var x=d("#swipebox-caption, #swipebox-action");x.addClass("visible-bars");u.setTimeout();d("body").bind("touchstart",function(i){d(this).addClass("touching");l=i.originalEvent.targetTouches[0];f.pageX=i.originalEvent.targetTouches[0].pageX;d(".touching").bind("touchmove",function(o){o.preventDefault();o.stopPropagation();l=o.originalEvent.targetTouches[0]});return false}).bind("touchend",function(i){i.preventDefault();i.stopPropagation();h=l.pageX-f.pageX;if(h>=p){u.getPrev()}else{if(h<=-p){u.getNext()}else{if(!x.hasClass("visible-bars")){u.showBars();u.setTimeout()}else{u.clearTimeout();u.hideBars()}}}d(".touching").off("touchmove").removeClass("touching")})}},setTimeout:function(){if(v.settings.hideBarsDelay>0){var f=this;f.clearTimeout();f.timeout=c.setTimeout(function(){f.hideBars()},v.settings.hideBarsDelay)}},clearTimeout:function(){c.clearTimeout(this.timeout);this.timeout=null},showBars:function(){var f=d("#swipebox-caption, #swipebox-action");if(this.doCssTrans()){f.addClass("visible-bars")}else{d("#swipebox-caption").animate({top:0},500);d("#swipebox-action").animate({bottom:0},500);setTimeout(function(){f.addClass("visible-bars")},1000)}},hideBars:function(){var f=d("#swipebox-caption, #swipebox-action");if(this.doCssTrans()){f.removeClass("visible-bars")}else{d("#swipebox-caption").animate({top:"-50px"},500);d("#swipebox-action").animate({bottom:"-50px"},500);setTimeout(function(){f.removeClass("visible-bars")},1000)}},animBars:function(){var h=this;var f=d("#swipebox-caption, #swipebox-action");if(!r){f.addClass("visible-bars");h.setTimeout();d("#swipebox-slider").click(function(i){if(!f.hasClass("visible-bars")){h.showBars();h.setTimeout()}});d("#swipebox-action").hover(function(){h.showBars();f.addClass("force-visible-bars");h.clearTimeout()},function(){f.removeClass("force-visible-bars");h.setTimeout()})}},keyboard:function(){if(!r){var f=this;d(c).bind("keyup",function(h){h.preventDefault();h.stopPropagation();if(h.keyCode==37){f.getPrev()}else{if(h.keyCode==39){f.getNext()}else{if(h.keyCode==27){f.closeSlide()}}}})}},actions:function(){var f=this;if(t.length<2){d("#swipebox-prev, #swipebox-next").hide()}else{d("#swipebox-prev").bind("click touchend",function(h){h.preventDefault();h.stopPropagation();f.getPrev();f.setTimeout()});d("#swipebox-next").bind("click touchend",function(h){h.preventDefault();h.stopPropagation();f.getNext();f.setTimeout()})}d("#swipebox-close").bind("click touchstart",function(h){f.closeSlide()})},setSlide:function(h){var f=d("#swipebox-slider");if(this.doCssTrans()){f.css({left:-h*100+"%"})}else{f.animate({left:-h*100+"%"})}d("#swipebox-slider .slide").removeClass("current");d("#swipebox-slider .slide").eq(h).addClass("current");this.setTitle(h);d("#swipebox-prev, #swipebox-next").removeClass("disabled");if(h==0){d("#swipebox-prev").addClass("disabled")}else{if(h==t.length-1){d("#swipebox-next").addClass("disabled")}}},openSlide:function(f){d("#swipebox-overlay").show().stop().animate({opacity:1},"slow").addClass("visible");setTimeout(function(){d("body").addClass("swipebox-overflow-hidden")},1500);this.setSlide(f)},preloadImg:function(h){var f=this;setTimeout(function(){f.openImg(h)},1000)},openImg:function(h){var f=this;if(h<0||h>=t.length){return false}f.loadImg(t.eq(h).attr("href"),function(){d("#swipebox-slider .slide").eq(h).html(this)})},setTitle:function(h){var f=null;if(t.eq(h).attr("title")){d("#swipebox-caption").empty().append(t.eq(h).attr("title"))}},loadImg:function(i,f){var h=d("<img>").on("load",function(){f.call(h)});h.attr("src",i)},getNext:function(){var f=this;index=d("#swipebox-slider .slide").index(d("#swipebox-slider .slide.current"));if(index+1<t.length){index++;f.setSlide(index);f.preloadImg(index+1)}else{d("#swipebox-slider").addClass("rightSpring");setTimeout(function(){d("#swipebox-slider").removeClass("rightSpring")},500)}},getPrev:function(){var f=this;index=d("#swipebox-slider .slide").index(d("#swipebox-slider .slide.current"));if(index>0){index--;f.setSlide(index);f.preloadImg(index-1)}else{d("#swipebox-slider").addClass("leftSpring");setTimeout(function(){d("#swipebox-slider").removeClass("leftSpring")},500)}},closeSlide:function(){var f=this;d("body").removeClass("swipebox-overflow-hidden");d("#swipebox-overlay").animate({opacity:0},"fast");setTimeout(function(){d("#swipebox-overlay").removeClass("visible");f.destroy()},1000)},destroy:function(){var f=this;d(c).unbind("keyup");d(c).unbind("resize");d("body").unbind();d("#swipebox-slider").unbind();d("#swipebox-overlay").remove();t.removeData("_swipebox")}};v.init()};d.fn.swipebox=function(g){if(!d.data(this,"_swipebox")){var f=new d.swipebox(this,g);this.data("_swipebox",f)}}})(window,document,jQuery);